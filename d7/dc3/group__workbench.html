<!-- HTML header for doxygen 1.9.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=11" />
        <meta name="generator" content="Doxygen 1.9.4" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>FreeCAD: Workbench Framework</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <script type="text/javascript" src="../../jquery.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <!--<link href='//fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>-->
        <link rel="stylesheet" href="../../freecad.css">
        <script type="text/javascript" src="../../doxy-boot.js"></script>
        <link rel="shortcut icon" href="https://freecadweb.org/images/favicon.ico">
    </head>
    <body>
        <div class="wrapper">
            <ul class="navbar" role="navigation">
                <li>
                    <a href="https://freecadweb.org" title="FreeCAD">
                        <img class="logo" src="https://www.freecad.org/svg/logo-freecad.svg">
                    </a>
                </li>
                <li><a href="../../index.html" title="Index">Index</a></li>
                <li><a href="../../modules.html" title="Modules list">Modules</a></li>
                <li><a href="../../annotated.html" title="Annotated list">Classes</a></li>
            </ul>
            <div id="top" class="maincontents"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Workbench Framework<div class="ingroups"><a class="el" href="../../d4/d68/group__CORE.html">Core</a> &raquo; <a class="el" href="../../df/dd1/group__GUI.html">Gui</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>FreeCAD provides the possibility to have one or more workbenches for a module.  
</p>
<p >FreeCAD provides the possibility to have one or more workbenches for a module. </p>
<p >A workbench changes the appearance of the main window in that way that it defines toolbars, items in the toolbox, menus or the context menu and dockable windows that are shown to the user. The idea behind this concept is that the user should see only the functions that are required for the task that they are doing at this moment and not to show dozens of unneeded functions which the user never uses.</p>
<h1><a class="anchor" id="stepbystep"></a>
Step by step</h1>
<p >Here follows a short description of how your own workbench can be added to a module.</p>
<h2><a class="anchor" id="newClass"></a>
Inherit either from Workbench or StdWorkbench</h2>
<p >First you have to subclass either <a class="el" href="../../d0/d97/classGui_1_1Workbench.html">Workbench</a> or <a class="el" href="../../db/d0a/classGui_1_1StdWorkbench.html">StdWorkbench</a> and reimplement the methods <a class="el" href="../../d0/d97/classGui_1_1Workbench.html#a5669c13ee2759f8b779c5ebcdfc9ecfa">setupMenuBar()</a>, <a class="el" href="../../d0/d97/classGui_1_1Workbench.html#a2c4bc1bd254e668905bb54553e5705df">setupToolBars()</a>, <a class="el" href="../../d0/d97/classGui_1_1Workbench.html#acd15496593629bd4f65a0cfe5c637896">setupCommandBars()</a> and <a class="el" href="../../d0/d97/classGui_1_1Workbench.html#a865cd438fc855d73e7ca1fa853ec1af6">setupDockWindows()</a>.</p>
<p >The difference between both classes is that these methods of Workbench are pure virtual while StdWorkbench defines already the standard menus and toolbars, such as the 'File', 'Edit', ..., 'Help' menus with their common functions.</p>
<p >If your class derives from Workbench then you have to define your menus, toolbars and toolbox items from scratch while deriving from StdWorkbench you have the possibility to add your preferred functions or even remove some unneeded functions. </p><div class="fragment"><div class="line"><span class="keyword">class </span>MyWorkbench : <span class="keyword">public</span> StdWorkbench</div>
<div class="line">{</div>
<div class="line"> ...</div>
<div class="line">protected:</div>
<div class="line">  MenuItem* setupMenuBar()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    MenuItem* root = StdWorkbench::setupMenuBar();</div>
<div class="line">    <span class="comment">// your changes</span></div>
<div class="line">    <span class="keywordflow">return</span> root;</div>
<div class="line">  }</div>
<div class="line">  ToolBarItem* setupToolBars()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    ToolBarItem* root = StdWorkbench::setupToolBars();</div>
<div class="line">    <span class="comment">// your changes</span></div>
<div class="line">    <span class="keywordflow">return</span> root;</div>
<div class="line">  }</div>
<div class="line">  ToolBarItem* setupCommandBars()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    ToolBarItem* root = StdWorkbench::setupCommandBars();</div>
<div class="line">    <span class="comment">// your changes</span></div>
<div class="line">    <span class="keywordflow">return</span> root;</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p> or </p><div class="fragment"><div class="line"><span class="keyword">class </span>MyWorkbench : <span class="keyword">public</span> <a class="code hl_class" href="../../da/d26/classWorkbench.html">Workbench</a></div>
<div class="line">{</div>
<div class="line"> ...</div>
<div class="line">protected:</div>
<div class="line">  MenuItem* setupMenuBar()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    MenuItem* root = <span class="keyword">new</span> MenuItem;</div>
<div class="line">    <span class="comment">// setup from scratch</span></div>
<div class="line">    <span class="keywordflow">return</span> root;</div>
<div class="line">  }</div>
<div class="line">  ToolBarItem* setupToolBars()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    ToolBarItem* root = <span class="keyword">new</span> ToolBarItem;</div>
<div class="line">    <span class="comment">// setup from scratch</span></div>
<div class="line">    <span class="keywordflow">return</span> root;</div>
<div class="line">  }</div>
<div class="line">  ToolBarItem* setupCommandBars()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    ToolBarItem* root = <span class="keyword">new</span> ToolBarItem;</div>
<div class="line">    <span class="comment">// setup from scratch</span></div>
<div class="line">    <span class="keywordflow">return</span> root;</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="customizeWorkbench"></a>
Customizing the workbench</h2>
<p >If you want to customize your workbench by adding or removing items you can use the ToolBarItem class for customizing toolbars and the MenuItem class for menus. Both classes behave basically the same. To add a new menu item you can do it as follows </p><div class="fragment"><div class="line">MenuItem* setupMenuBar()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  MenuItem* root = StdWorkbench::setupMenuBar();</div>
<div class="line">  <span class="comment">// create a sub menu</span></div>
<div class="line">  MenuItem* mySub = <span class="keyword">new</span> MenuItem; <span class="comment">// note: no parent is given</span></div>
<div class="line">  mySub-&gt;setCommand( <span class="stringliteral">&quot;My &amp;Submenu&quot;</span> );</div>
<div class="line">  *mySub &lt;&lt; <span class="stringliteral">&quot;Std_Undo&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Std_Redo&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// My menu</span></div>
<div class="line">  MenuItem* myMenu = <span class="keyword">new</span> MenuItem( root );</div>
<div class="line">  myMenu-&gt;setCommand( <span class="stringliteral">&quot;&amp;My Menu&quot;</span> );</div>
<div class="line">  <span class="comment">// fill up the menu with some command items</span></div>
<div class="line">  *myMenu &lt;&lt; mySub &lt;&lt; <span class="stringliteral">&quot;Separator&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Std_Cut&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Std_Copy&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Std_Paste&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Separator&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Std_Undo&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Std_Redo&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p >Toolbars can be customized the same way unless that you shouldn't create subitems (there are no subtoolbars).</p>
<h2><a class="anchor" id="regWorkbench"></a>
Register your workbench</h2>
<p >Once you have implemented your workbench class you have to register it to make it known to the FreeCAD core system. You must make sure that the step of registration is performed only once. A good place to do it is e.g. in the global function initMODULEGui in AppMODULEGui.cpp where MODULE stands for the name of your module. Just add the line </p><div class="fragment"><div class="line">MODULEGui::MyWorkbench::init();</div>
</div><!-- fragment --><p> somewhere there.</p>
<h2><a class="anchor" id="itemWorkbench"></a>
Create an item for your workbench</h2>
<p >Though your workbench has been registered now, at this stage you still cannot invoke it yet. Therefore you must create an item in the list of all visible workbenches. To perform this step you must open your InitGui.py (a Python file) and do some adjustments. The file contains already a Python class MODULEWorkbench that implements the Activate() method (it imports the needed library). You can also implement the GetIcon() method to set your own icon for your workbench, if not, the default FreeCAD icon is taken, and finally the most important method GetClassName(). that represents the link between Python and C++. This method must return the name of the associated C++ including namespace. In this case it must the string "ModuleGui::MyWorkbench". At the end you can change the line from </p><div class="fragment"><div class="line"><a class="code hl_namespace" href="../../d9/dad/namespaceGui.html" title="The FreeCAD Graphical interface layer.">Gui</a>.addWorkbench(<span class="stringliteral">&quot;MODULE design&quot;</span>,MODULEWorkbench())</div>
</div><!-- fragment --><p> to </p><div class="fragment"><div class="line"><a class="code hl_namespace" href="../../d9/dad/namespaceGui.html" title="The FreeCAD Graphical interface layer.">Gui</a>.addWorkbench(<span class="stringliteral">&quot;My workbench&quot;</span>,MODULEWorkbench())</div>
</div><!-- fragment --><p> or whatever you want. </p><dl class="section note"><dt>Note</dt><dd>You must make sure to choose a unique name for your workbench (in this example "My workbench"). Since FreeCAD doesn't provide a mechanism for this you have to care on your own.</dd></dl>
<h1><a class="anchor" id="moredetails"></a>
More details and limitations</h1>
<p >One of the key concepts of the workbench framework is to load a module at runtime when the user needs some function that it provides. So, if the user doesn't need a module it never gets loaded into RAM. This speeds up the startup procedure of FreeCAD and saves memory.</p>
<p >At startup FreeCAD scans all module directories and invokes InitGui.py. So an item for a workbench gets created. If the user clicks on such an item the matching module gets loaded, the C++ workbench gets registered and activated.</p>
<p >The user is able to modify a workbench (Edit|Customize). E.g. they can add new toolbars or items for the toolbox and add their preferred functions to them. But the user only has full control over "their" own toolbars, the default workbench items cannot be modified or even removed.</p>
<p >FreeCAD provides also the possibility to define pure Python workbenches. Such workbenches are temporarily only and are lost after exiting the FreeCAD session. But if you want to keep your Python workbench you can write a macro and attach it with a user defined button or just perform the macro during the next FreeCAD session. Here follows a short example of how to create and embed a workbench in Python </p><div class="fragment"><div class="line">w=<a class="code hl_class" href="../../da/d26/classWorkbench.html">Workbench</a>()                                              <span class="preprocessor"># creates a standard workbench (the same as StdWorkbench in C++)</span></div>
<div class="line">w.MenuText = <span class="stringliteral">&quot;My Workbench&quot;</span>                                # the <a class="code hl_namespace" href="../../de/d0e/namespacetext.html" title="Provides the object code for the Text object.">text</a> that will appear in the combo box</div>
<div class="line">dir(w)                                                     <span class="preprocessor"># lists all available function of the object</span></div>
<div class="line">FreeCADGui.addWorkbench(w)                                 # Creates an item <span class="keywordflow">for</span> our workbench now</div>
<div class="line"><span class="preprocessor">                                                           # Note: We must first add the workbench to run some initialization code</span></div>
<div class="line"><span class="preprocessor">                                                           # Then we are ready to customize the workbench</span></div>
<div class="line">list = [<span class="stringliteral">&quot;Std_Test1&quot;</span>, <span class="stringliteral">&quot;Std_Test2&quot;</span>, <span class="stringliteral">&quot;Std_Test3&quot;</span>]             # creates a list of <span class="keyword">new</span> functions</div>
<div class="line">w.appendMenu(<span class="stringliteral">&quot;Test functions&quot;</span>, list)                       # creates a <span class="keyword">new</span> menu with these functions</div>
<div class="line">w.appendToolbar(<span class="stringliteral">&quot;Test&quot;</span>, list)                              # ... and also a <span class="keyword">new</span> toolbar</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.9.4-->
</div>
<!-- start footer part -->
<hr /><address class="footer"><small>
  Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
  </small></address>
</body>
</html>
